<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Heaven Loading</title>
  <style>
    :root{
      --ease: cubic-bezier(.18,.8,.2,1);
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        radial-gradient(circle at 10% 0%, #f8fbff 0, #e3f0ff 16%, #0b0f18 62%, #020308 100%);
      color:#f7f8ff;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      overflow:hidden;
      position:relative;
    }

    /* ===== 배경 레이어 정리 ===== */
    .bg-layer {
      position:absolute;
      inset:-10%;
      background-position: center top;
      background-size: cover;
      background-repeat: no-repeat;
      opacity: 0.4;
      pointer-events:none;
      z-index:0;
    }

    .bg-1 { background-image: url("assets/heaven/heaven_bg_1.jpg"); }
    .bg-2 { background-image: url("assets/heaven/heaven_bg_2.jpg"); }
    .bg-3 { 
      background-image: url("assets/heaven/heaven_bg_3.gif"); 
      opacity: 0.2; /* GIF 투명도 20% */
    }

    
    /* ===== 애니메이션 ===== */
    @keyframes heaven-haze{
      0%{ opacity:.35; transform:translate3d(0,6px,0) scale(1); }
      50%{ opacity:.85; transform:translate3d(-8px,-4px,0) scale(1.03); }
      100%{ opacity:.55; transform:translate3d(6px,4px,0) scale(1.02); }
    }

    .wrap{
      position:relative;
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      gap:18px;
      padding:0 24px;
      background:transparent;
      border-radius:0;
      width:100%;
      max-width:520px;
      z-index:1;
      filter:drop-shadow(0 0 26px rgba(210,228,255,.9));
    }

    /* 하늘 빛 */
    .heaven-light{
      position:absolute;
      top:-25%;
      left:50%;
      width:140vw;
      height:120vh;
      transform:translateX(-50%);
      background:
        radial-gradient(circle at 50% 0%, rgba(255,255,255,0.98) 0,
                                      rgba(238,246,255,0.85) 10%,
                                      rgba(210,226,255,0.45) 24%,
                                      rgba(6,12,32,0) 60%);
      mix-blend-mode:screen;
      opacity:.9;
      pointer-events:none;
      filter:blur(1.5px);
      z-index:0;
      animation:heaven-light-pulse 8s ease-in-out infinite alternate;
    }

    @keyframes heaven-light-pulse{
      0%{ opacity:.7; transform:translate3d(-50%,0,0) scale(1); }
      50%{ opacity:1; transform:translate3d(-50%,6px,0) scale(1.03); }
      100%{ opacity:.75; transform:translate3d(-50%,2px,0) scale(1.01); }
    }

    /* 빛 먼지 */
    .heaven-dust-layer{
      position:absolute;
      inset:-10% -10% 35% -10%;
      pointer-events:none;
      z-index:0;
      background-image:
        radial-gradient(circle, rgba(255,255,255,0.52) 0, transparent 55%),
        radial-gradient(circle, rgba(230,240,255,0.45) 0, transparent 60%),
        radial-gradient(circle, rgba(255,255,255,0.36) 0, transparent 60%);
      background-size:260px 260px, 340px 340px, 420px 420px;
      background-position:10% 10%, 60% 0%, 85% 18%;
      mix-blend-mode:screen;
      opacity:.55;
      animation:heaven-dust-drift 16s linear infinite alternate;
    }

    @keyframes heaven-dust-drift{
      0%{ background-position:12% 12%, 58% 0%, 80% 20%; opacity:.4; }
      50%{ background-position:8% 6%, 62% 4%, 86% 14%; opacity:.7; }
      100%{ background-position:14% 4%, 56% -4%, 82% 10%; opacity:.45; }
    }

    /* 텍스트 스타일 */
    .title{
      font-size:clamp(13px,2.5vw,16px);
      letter-spacing:0.22em;
      text-transform:uppercase;
      opacity:.82;
      text-shadow:
        0 0 10px rgba(218,230,255,.9),
        0 0 26px rgba(179,210,255,.95);
    }

    .percent{
      font-size:clamp(26px,4.2vw,32px);
      font-weight:800;
      letter-spacing:0.18em;
      text-transform:uppercase;
      text-shadow:
        0 0 14px rgba(255,255,255,1),
        0 0 38px rgba(205,227,255,.9),
        0 0 52px rgba(164,209,255,.95);
    }

    .percent span{
      font-variant-numeric:tabular-nums;
    }

    /* ===== 유리관 로딩바 디자인 수정 ===== */
    .bar-shell{
      position:relative;
      margin-top:10px;
      width:min(80vw,420px);
      height:32px; /* 유리관 두께 */
      border-radius:50px; /* 둥근 캡슐 형태 */
      
      /* 투명한 유리 질감 */
      background: rgba(200, 220, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.15); /* 얇은 유리 테두리 */
      
      /* 유리관 입체감 (내부 그림자와 외부 광택) */
      box-shadow:
        inset 0 4px 6px rgba(255, 255, 255, 0.2),  /* 상단 하이라이트 */
        inset 0 -4px 6px rgba(0, 0, 0, 0.1),       /* 하단 음영 */
        0 0 15px rgba(255, 255, 255, 0.1);         /* 외부 발광 */
        
      backdrop-filter:blur(3px);
      overflow:hidden;
      padding: 3px; /* 유리관 두께만큼 내부 여백 */
    }

    /* 유리관 표면의 광택 (Highlihgt) */
    .bar-shell::after {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; height: 50%;
      background: linear-gradient(to bottom, rgba(255,255,255,0.15), transparent);
      border-radius: 50px 50px 0 0;
      pointer-events: none;
      z-index: 3;
    }

    .bar-fill{
      position: relative; /* padding 안쪽으로 배치 */
      height: 100%;
      width: 0%;
      border-radius: 50px;
      
      /* 피(Blood) 질감: 어두운 적색 -> 밝은 적색 -> 어두운 적색 (원통형 입체감) */
      background: linear-gradient(180deg, 
        #4a0000 0%, 
        #850000 30%, 
        #d10000 50%, 
        #850000 70%, 
        #360000 100%
      );
      
      /* 피 자체의 발광 및 깊이감 */
      box-shadow:
        0 0 15px rgba(200, 0, 0, 0.6),
        inset 2px 0 5px rgba(0,0,0,0.5);
        
      transition: width 120ms var(--ease);
      z-index:1;
    }

    /* 액체 윗부분의 하이라이트 (물기 어린 느낌) */
    .bar-fill::before{
      content:"";
      position:absolute;
      top: 2px; left: 2px; right: 2px; height: 35%;
      background: linear-gradient(to bottom, rgba(255,255,255,0.5), transparent);
      border-radius: 50px 50px 100% 100%;
      opacity: 0.6;
    }

    /* 반짝이 파티클 레이어 */
    .spark-layer{
      position:absolute;
      left:0; right:0; top:-52px; bottom:0;
      pointer-events:none;
      mix-blend-mode:screen;
      z-index:2;
    }

    .spark{
      position:absolute;
      width:4px; height:4px;
      border-radius:50%;
      background:radial-gradient(circle,#fdfdff 0,#e6fbff 32%,rgba(200,225,255,0) 72%);
      box-shadow:
        0 0 10px rgba(240,248,255,1),
        0 0 22px rgba(204,241,255,.95),
        0 0 40px rgba(178,217,255,.9);
      filter:blur(.1px);
      animation:spark-fly 1100ms ease-out forwards;
    }

    @keyframes spark-fly{
      0%{ transform:translate3d(0,4px,0) scale(0.22); opacity:0; }
      18%{ transform:translate3d(0,-4px,0) scale(0.65); opacity:1; }
      60%{ transform:translate3d(6px,-30px,0) scale(1.02); opacity:.92; }
      100%{ transform:translate3d(10px,-52px,0) scale(1.1); opacity:0; }
    }

    .sub{
      margin-top:10px;
      font-size:clamp(11px,1.9vw,13px);
      opacity:.82;
      letter-spacing:0.08em;
      text-shadow:
        0 0 10px rgba(214,229,255,.9),
        0 0 28px rgba(169,206,255,.9);
    }

    @media (max-width:520px){
      .wrap{ padding:0 16px; }
    }
  </style>
</head>
<body>
  <div class="bg-layer bg-1"></div>
  <div class="bg-layer bg-2"></div>
  <div class="bg-layer bg-3"></div>

  <div class="heaven-light"></div>
  <div class="heaven-dust-layer"></div>
  
  <div class="wrap">
    <div class="title">Heaven concept</div>
    <div class="percent">Loding... <span id="percentText">00%</span></div>

    <div class="bar-shell">
      <div class="bar-fill" id="barFill"></div>
      <div class="spark-layer" id="sparkLayer"></div>
    </div>

    <div class="sub">Preparing your heaven stage...</div>
  </div>

  <script>
    (function() {
      const percentText = document.getElementById("percentText");
      const barFill = document.getElementById("barFill");
      const sparkLayer = document.getElementById("sparkLayer");

      let p = 0;

      function spawnSparks(intensity){
        if (!sparkLayer) return;

        const base = Math.max(4, intensity * 3);
        const count = base + Math.floor(Math.random() * base * 1.4);

        for (let i = 0; i < count; i++){
          const s = document.createElement("div");
          s.className = "spark";

          const jitter = (Math.random() - 0.5) * 7; 
          let tip = p + jitter;
          tip = Math.max(0, Math.min(100, tip));
          s.style.left = tip + "%";
          s.style.bottom = "6%";

          const life = 820 + Math.random() * 620;
          s.style.animationDuration = life + "ms";
          s.style.opacity = (0.55 + Math.random() * 0.4).toFixed(2);

          sparkLayer.appendChild(s);

          setTimeout(() => {
            s.remove();
          }, life + 400);
        }
      }

      const tick = () => {
        const step = Math.floor(Math.random() * 9) + 4; 
        p = Math.min(100, p + step);

        const shown = p.toString().padStart(2, "0") + "%";
        if(percentText) percentText.textContent = shown;
        if(barFill) barFill.style.width = p + "%";

        let intensity;
        if (p < 30) intensity = 2;          
        else if (p < 65) intensity = 5;     
        else if (p < 90) intensity = 10;    
        else intensity = 18;               
        spawnSparks(intensity);

        if (p >= 100) {
          setTimeout(() => {
            window.location.href = "heaven.html";
          }, 450);
        } else {
          setTimeout(tick, 90);
        }
      };

      setTimeout(tick, 220);
    })();
  </script>
</body>
</html>